# Studio - 패치노트

## 버전 2.2.5 (2025.08.30) - 백엔드 배포 문제 해결

### 🚨 긴급 수정사항

#### 1. 백엔드 배포 문제 진단
- **문제**: 로그인/회원가입 시 "Failed to fetch" 에러 발생
- **원인**: 
  - 백엔드가 별도 Railway 서비스로 배포되지 않음
  - 프론트엔드가 자체 URL을 백엔드 URL로 잘못 참조
  - PostgreSQL 데이터베이스는 생성되었으나 스키마가 초기화되지 않음
- **영향**: 모든 사용자가 로그인/회원가입 불가

#### 2. Railway 백엔드 배포 가이드

##### 2.1 Railway 대시보드에서 새 서비스 추가
1. Railway 대시보드 접속
2. **New** → **GitHub Repo** → `gatat123/art` 선택
3. **서비스 이름**: `studio-backend`
4. **Root Directory**: `storyboard-collab/backend`

##### 2.2 환경변수 설정 (Railway Variables)
```
DATABASE_URL=<PostgreSQL 서비스에서 자동 제공>
JWT_SECRET=your-super-secret-jwt-key-2024-production
NODE_ENV=production
FRONTEND_URL=https://art-production-a9ab.up.railway.app
PORT=3001
ADMIN_USERNAME=HSG202
ADMIN_PASSWORD=1004mobil!#
ADMIN_EMAIL=admin@studio.com
```

##### 2.3 빌드 및 시작 명령어 설정
- **Build Command**: `npm install && npm run init-db`
- **Start Command**: `npm start`

##### 2.4 도메인 생성
Railway에서 백엔드 서비스에 도메인 생성 후, 프론트엔드 환경변수 업데이트

#### 3. 프론트엔드 환경변수 수정
`.env.production` 파일 생성/수정:
```env
NEXT_PUBLIC_API_URL=https://studio-backend-production.up.railway.app/api
BUILD_ID=v2.2.5-backend-fix
FORCE_REBUILD=true
```

#### 4. 로컬 개발 환경 설정
`.env.local` 파일:
```env
NEXT_PUBLIC_API_URL=http://localhost:3001/api
```

---

### 🔧 임시 해결방법

백엔드 배포가 완료될 때까지 localStorage 기반 인증 사용:

1. 데모 계정으로만 로그인 가능
   - 사용자명: `demo`
   - 비밀번호: `demo123`

2. 관리자 계정 (백엔드 연결 후 사용 가능)
   - 사용자명: `HSG202`
   - 비밀번호: `1004mobil!#`

---

### 📋 체크리스트

- [ ] Railway에서 백엔드 서비스 생성
- [ ] PostgreSQL 연결 확인
- [ ] 환경변수 설정 완료
- [ ] 백엔드 도메인 생성
- [ ] 프론트엔드 환경변수 업데이트
- [ ] 데이터베이스 스키마 초기화 확인
- [ ] Health check 엔드포인트 테스트
- [ ] 로그인/회원가입 기능 테스트

---

### 🚀 배포 순서

1. **백엔드 Railway 서비스 생성**
2. **환경변수 설정**
3. **배포 대기 (약 5-10분)**
4. **백엔드 Health Check 확인**
   ```
   https://[백엔드-도메인]/api/health
   ```
5. **프론트엔드 환경변수 업데이트**
6. **프론트엔드 재배포**

---

### 📝 추가 참고사항

- PostgreSQL 서비스는 이미 생성되어 있음
- `DATABASE_URL`은 Railway에서 자동으로 주입
- 백엔드 로그는 Railway 대시보드에서 실시간 확인 가능
- 첫 배포 시 `init-db` 스크립트가 자동으로 스키마 생성 및 관리자 계정 생성

---

### 🐛 알려진 이슈

- 프론트엔드와 백엔드가 동일한 도메인 사용 중
- API 요청이 프론트엔드로 잘못 라우팅됨
- CORS 설정 확인 필요

---

### 🔄 다음 단계

1. 백엔드 별도 배포 완료
2. WebSocket 연결 설정
3. 이미지 업로드 기능 구현
4. 실시간 협업 기능 추가

---

**Last Updated**: 2025.08.30  
**Current Version**: 2.2.5  
**Status**: Critical Fix Required 🚨  
**GitHub Repository**: https://github.com/gatat123/art  
**Production URL**: https://art-production-a9ab.up.railway.app/

---

**© 2025 Studio. All rights reserved.**